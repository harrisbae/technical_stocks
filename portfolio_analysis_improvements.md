# 포트폴리오 분석 도구 개선사항

## 주요 개선사항 요약

포트폴리오 분석 도구(`analyze_portfolio_table.py`)에 다음과 같은 개선사항이 추가되었습니다:

1. **종합평가 위치 조정**: 종합평가 항목을 추천매도가 항목 다음으로 이동하여 더 직관적인 레이아웃으로 구성했습니다.

2. **종합평가 근거 추가**: 종합평가에 근거를 추가하여 매수/매도 추천의 이유를 명확하게 제시합니다.
   - 예: `매도 (7:0:12) - 모멘텀 지표 매도신호, 강한상승추세`
   - 괄호 안의 숫자는 (매수:중립:매도) 점수를 나타냅니다.

3. **매수/매도 색상 구분**: Excel 파일에서 종합평가가 매수인 종목은 녹색으로, 매도인 종목은 빨간색으로 셀을 채워 시각적 구분을 강화했습니다.

4. **열 너비 자동 조정**: 테이블의 모든 열 너비를 내용에 맞게 자동 조정하여 데이터가 잘 표시되도록 개선했습니다.

5. **기술평가 전략 시트 추가**: Excel 파일에 기술적 지표와 종합평가 방법론을 설명하는 별도의 시트를 추가했습니다.

## 기술평가 전략 시트 내용

Excel 파일의 "기술평가 전략" 시트에는 다음과 같은 섹션이 포함되어 있습니다:

### 1. 종합평가 기준
- **강매수**: 매수 점수가 매도 점수의 2배 이상 & 매수 점수 65% 이상
- **매수**: 매수 점수 > 매도 점수 & 매수 점수 45% 이상
- **보유**: 매수/매도 점수가 균형을 이루는 상태
- **매도**: 매도 점수 > 매수 점수 & 매도 점수 45% 이상
- **강매도**: 매도 점수가 매수 점수의 2배 이상 & 매도 점수 65% 이상

### 2. 기술적 지표별 해석 및 배점
| 지표 | 매수 신호 | 중립 신호 | 매도 신호 | 가중치 | 특징 |
|------|----------|-----------|----------|-------|------|
| 볼린저 밴드 | 위치 < 20% | 20% < 위치 < 80% | 위치 > 80% | 2 | 변동성과 추세의 강도를 측정 |
| MACD | MACD > Signal & 상승 | MACD ≈ Signal | MACD < Signal & 하락 | 2 | 중장기 추세 방향을 파악 |
| RSI | RSI < 30 | 30 < RSI < 70 | RSI > 70 | 2 | 과매수/과매도 상태와 모멘텀 측정 |
| CCI | CCI < -100 | -100 < CCI < 100 | CCI > 100 | 1 | 평균 가격과의 괴리 측정 |
| ADX | ADX > 25 & +DI > -DI | ADX < 20 | ADX > 25 & +DI < -DI | 2 | 추세의 강도를 측정 |
| Williams %R | Williams < -80 | -80 < Williams < -20 | Williams > -20 | 1 | 과매수/과매도 상태 측정 |
| Stochastic | %K < 20 & %K > %D | %K와 %D 교차 | %K > 80 & %K < %D | 2 | 모멘텀과 추세 반전 신호 포착 |

### 3. 지표 간 상관관계 활용 전략
| 조합 | 시너지 효과 | 해석 |
|------|------------|------|
| MACD + ADX | 추세 방향 + 강도 결합 | MACD 상승 + ADX > 25 + +DI > -DI = 강한 상승 추세 확인 |
| RSI + Williams %R | 모멘텀 지표 교차 검증 | 두 지표가 동시에 과매수/과매도 신호시 신뢰도 상승 |
| 볼린저 밴드 + Stochastic | 변동성 + 모멘텀 결합 | 밴드 하단 접근 + Stochastic 상향돌파 = 강한 반등 신호 |
| CCI + Stochastic | 사이클 + 반전 신호 결합 | 두 지표 모두 과매도에서 반등 신호시 매수 신뢰도 상승 |

### 4. 실전 투자 전략
| 시장 상황 | 활용 지표 | 대응 전략 |
|----------|-----------|----------|
| 상승 추세 | MACD, ADX, Stochastic | 매수 포지션 강화, 추세 추종 전략 구사 |
| 하락 추세 | MACD, ADX, Bollinger | 매도 포지션 강화, 추세 추종 또는 반등 대비 |
| 횡보장 | RSI, CCI, Williams %R | 박스권 돌파/이탈 확인 후 대응, 단기 스윙 전략 |
| 변동성 높음 | Bollinger 밴드폭, ADX | 포지션 축소, 리스크 관리 강화 |
| 변동성 낮음 | Bollinger 밴드폭, MACD | 변동성 확대 대비, 브레이크아웃 전략 |

### 5. 종합평가 해석 가이드
* 종합평가는 7개 주요 기술적 지표의 신호를 종합적으로 분석한 결과입니다.
* 평가 결과 옆의 괄호 안 숫자 (예: 5:2:3)는 각각 매수:중립:매도 점수를 의미합니다.
* 평가 근거가 있는 경우 '매수 (5:1:2) - 모멘텀 지표 매수신호' 형태로 표시됩니다.
* 모든 기술적 지표는 서로 다른 측면을 측정하므로, 종합적인 판단이 중요합니다.
* 시장 상황과 개별 종목의 펀더멘털을 함께 고려하여 최종 투자 판단을 내려야 합니다.
* 기술적 분석은 과거 데이터 기반의 확률적 접근법으로, 미래 가격을 보장하지 않습니다.

## 사용 방법

1. `stocks.txt` 파일에 분석할 종목 정보를 입력합니다.
2. `python analyze_portfolio_table.py` 명령어로 분석을 실행합니다.
3. 분석 결과가 화면에 표시되고 Excel 및 CSV 파일로 저장됩니다. (`./temp` 폴더)
4. Excel 파일에서 색상 표시와 기술평가 전략 시트를 확인할 수 있습니다.

이러한 개선사항은 포트폴리오 분석 결과를 더 명확하게 이해하고 활용하는 데 도움이 될 것입니다. 